# Tuanki 卡片解析用户指南

## 🎯 快速开始

Tuanki 的卡片解析系统让您可以用简单的 Markdown 语法创建学习卡片。无需复杂的模板配置，只需要掌握几个基本符号即可开始使用。

## 📝 基本语法

### 1. 问答卡片

最简单的卡片格式，使用 `---div---` 分隔问题和答案：

```markdown
什么是 TypeScript？ #编程
---div---
TypeScript 是 JavaScript 的超集，添加了静态类型检查。
```

**效果**：
- 正面显示：什么是 TypeScript？
- 背面显示：TypeScript 是 JavaScript 的超集，添加了静态类型检查。
- 标签：#编程

### 2. 无分隔符卡片

如果不使用 `---div---`，整个内容会显示在正面：

```markdown
记住这个重要概念：函数式编程强调不可变性和纯函数。 #编程概念
```

**效果**：
- 正面显示：整个内容
- 背面：空白

### 3. 选择题卡片

使用复选框语法创建选择题：

```markdown
以下哪个是 JavaScript 的数据类型？ #JavaScript
- [ ] int
- [x] string
- [x] boolean
- [ ] float
---div---
JavaScript 的基本数据类型包括 string、boolean、number 等。
```

**效果**：
- 正面显示题目和选项
- 背面显示解析
- 自动识别正确答案（[x] 标记）

### 4. 挖空卡片

使用 `==文本==` 创建挖空：

```markdown
JavaScript 中 ==var== 和 ==let== 的主要区别是作用域。 #JavaScript
```

**效果**：
- 学习时会隐藏高亮部分
- 显示为：JavaScript 中 [...] 和 [...] 的主要区别是作用域。

## 🔧 配置选项

### 访问设置

1. 打开 Obsidian 设置
2. 找到 Tuanki 插件
3. 点击"卡片解析"标签页

### 核心配置

#### 标签触发
- **启用**：只有包含指定标签的内容才会被解析
- **禁用**：所有符合格式的内容都会被解析
- **默认标签**：`#tuanki`

#### 符号自定义
- **正反面分隔符**：默认 `---div---`
- **卡片分隔符**：默认 `---卡片---`（批量解析时使用）
- **挖空标记**：默认 `==文本==`

#### 批量解析范围
- **开始标记**：默认 `---start---`
- **结束标记**：默认 `---end---`

## 📚 批量解析

### 基本格式

使用新的范围标记来批量创建卡片：

```markdown
---tuanki/start---

## 第一张卡片
什么是 React？ #前端
---div---
React 是用于构建用户界面的 JavaScript 库。

---cd---

## 第二张卡片
Vue.js 的核心特性是什么？ #前端
---div---
Vue.js 的核心特性包括响应式数据绑定和组件化。

---cd---

## 第三张卡片
这是一个==挖空题==，会自动识别为挖空类型。 #前端

---tuanki/end---
```

### 分隔符说明

- **`---tuanki/start---`**: 批量解析范围开始
- **`---tuanki/end---`**: 批量解析范围结束
- **`---cd---`**: 卡片分隔符，用于分隔多张卡片
- **`---div---`**: 正反面分隔符，用于问答题和选择题
- **`==text==`**: 挖空标记，用于挖空题

### 题型自动识别

Tuanki 会根据内容格式自动识别题型：

| 内容特征 | 识别为 |
|---------|--------|
| 包含 `---div---` | 问答题 |
| 包含 `==text==` 或 `{{c1::text}}` | 挖空题 |
| 包含 `- [x]` 或 `A./B./C.` | 选择题 |
| 无特殊标记 | 默认问答题（只有正面） |

### 混合题型示例

可以在同一个范围内混合不同类型的卡片：

```markdown
---tuanki/start---

## 问答题
什么是闭包？ #JavaScript
---div---
闭包是函数和其词法环境的组合。

---cd---

## 选择题
以下哪个是 ES6 新特性？ #JavaScript
- [x] 箭头函数
- [ ] var 声明
- [x] 模板字符串
- [ ] function 关键字

---cd---

## 挖空题
==Promise== 是 JavaScript 中处理异步操作的对象。 #JavaScript

---tuanki/end---
```

### 块链接功能（可选）

#### 什么是块链接？

块链接是 Obsidian 的原生功能，格式为 `^blockId`，可以精确定位到文档中的某个段落或块。

#### 启用块链接

在插件设置 → 卡片解析 → 批量解析配置中，开启"自动创建块链接"：

- ✅ **启用**：批量解析时自动在源文档中插入块ID
- ❌ **禁用**（默认）：不修改源文档

#### 启用后的效果

```markdown
---tuanki/start---

## 什么是闭包？
闭包是函数和其词法环境的组合。

^tuanki-abc123-0-xy4k

---cd---

## Promise 的作用
Promise 用于处理异步操作。

^tuanki-abc123-1-zw7m

---tuanki/end---
```

#### 使用块链接

启用后，在卡片管理界面可以看到"源文件"列，点击链接图标可直接跳转到源文档的精确位置。

### 批量解析工作流

#### 手动触发方式

1. **创建范围**：在笔记中添加 `---tuanki/start---` 和 `---tuanki/end---`
2. **编写卡片**：在范围内编写多张卡片，用 `---cd---` 分隔
3. **触发解析**：
   - **命令面板**：`Ctrl/Cmd + P` → 搜索"批量解析当前文件"
   - **快捷键**：在 Obsidian 设置 → 快捷键中自定义（建议 `Ctrl+Shift+P`）
4. **自动创建**：插件自动识别题型并创建卡片
5. **块链接插入**（可选）：如果启用，自动在源文档插入块ID

#### 自动触发方式（推荐）

1. **启用自动触发**：
   - 打开插件设置 → 卡片解析 → 扫描范围
   - 开启"启用自动触发"
   - 设置防抖延迟（建议 2000ms）

2. **工作原理**：
   - 当你在 Markdown 文件中编辑时
   - 如果文件包含 `---tuanki/start---` 和 `---tuanki/end---`
   - 编辑停止 2 秒后自动解析并创建卡片
   - ✅ **仅对当前正在编辑的文件生效**

3. **优势**：
   - 无需手动执行命令
   - 实时反馈，提高效率
   - 不会干扰其他文件

### 扫描范围配置

在插件设置 → 卡片解析 → 扫描范围中，可以配置批量解析的文件夹范围：

#### 包含文件夹

指定需要扫描的文件夹。留空则扫描整个库（除排除列表外）。

**使用场景**：
- 只想扫描特定文件夹（如 `学习笔记/编程`）
- 避免扫描无关文件夹，提升性能

**配置方法**：
1. 点击"+ 添加文件夹"
2. 从下拉列表选择文件夹
3. 保存设置

#### 排除文件夹

指定需要排除的文件夹（不会被扫描）。

**默认排除**：
- `.obsidian` - Obsidian 配置文件夹
- `.trash` - 回收站
- `node_modules` - 依赖包文件夹
- `.git` - Git 仓库文件夹

**使用场景**：
- 排除模板文件夹
- 排除存档文件夹
- 排除其他不需要扫描的文件夹

#### 批量处理限制

**单次批量处理最大文件数**（默认 50）：
- 手动触发"批量解析所有文件"命令时的文件数量限制
- 防止一次性处理过多文件导致性能问题
- 建议值：50-100

### 命令说明

插件提供以下批量解析命令：

| 命令 | 功能 | 快捷键设置 | 说明 |
|------|------|------------|------|
| 批量解析当前文件 | 解析当前正在编辑的文件 | 可自定义 | 仅对当前文件生效 |
| 批量解析所有文件（按扫描范围） | 按照扫描范围批量解析 | 可自定义 | 根据包含/排除配置扫描 |

**配置快捷键方法**：
1. 打开 Obsidian 设置 → 快捷键
2. 搜索"批量解析"
3. 点击命令右侧的"+"号设置快捷键
4. **注意**：插件不预设快捷键，避免与其他插件冲突

### 性能优化建议

1. **自动触发防抖延迟**：
   - 设置为 2000-3000ms
   - 避免频繁触发，减少 CPU 占用

2. **文件夹范围配置**：
   - 仅包含必要的文件夹
   - 排除大型文件夹（如 `node_modules`）

3. **批量处理限制**：
   - 单次批量处理不超过 50-100 个文件
   - 大型库分批处理

### 注意事项

- 批量解析只会识别范围内的内容，范围外的内容不会被处理
- 每张卡片应该完整包含题目和答案（如果是问答题）
- 空卡片（内容为空的分隔符之间）会被自动跳过
- 块链接插入失败不会影响卡片创建

## 🎨 高级技巧

### 1. 使用 Markdown 格式

卡片内容支持完整的 Markdown 语法：

```markdown
## 代码示例 #编程
---div---
```javascript
function fibonacci(n) {
  if (n <= 1) return n;
  return fibonacci(n-1) + fibonacci(n-2);
}
```

这是递归实现的斐波那契数列。
```

### 2. 添加图片和链接

```markdown
什么是 MVC 架构？ #架构模式
---div---
MVC（Model-View-Controller）是一种软件架构模式。

![MVC架构图](mvc-diagram.png)

参考：[MVC 详解](https://example.com/mvc)
```

### 3. 使用表格

```markdown
HTTP 状态码分类 #网络
---div---
| 类别 | 范围 | 含义 |
|------|------|------|
| 1xx | 100-199 | 信息响应 |
| 2xx | 200-299 | 成功响应 |
| 3xx | 300-399 | 重定向 |
| 4xx | 400-499 | 客户端错误 |
| 5xx | 500-599 | 服务器错误 |
```

## ❓ 常见问题

### Q: 为什么我的卡片没有被解析？
A: 检查以下几点：
1. 是否启用了标签触发，但内容中没有指定标签
2. 符号配置是否正确
3. 内容格式是否符合解析规范

### Q: 如何修改默认的分隔符？
A: 在插件设置的"卡片解析"页面中，找到"核心分隔符"部分进行修改。

### Q: 选择题的正确答案如何标记？
A: 使用 `[x]` 标记正确选项，或在选项后添加 `✓`、`(正确)` 等标记。

### Q: 挖空卡片支持多个挖空吗？
A: 支持。每个 `==文本==` 都会成为一个挖空点，系统会自动编号。

### Q: 批量解析时如何处理错误？
A: 系统会跳过有问题的卡片，继续处理其他卡片，并在日志中记录错误信息。

## 🔗 相关链接

- [技术规范文档](../SPEC_MD_CARD_PARSING_V2.zh-CN.md)
- [系统架构说明](../SIMPLIFIED_CARD_PARSING_SYSTEM.md)
- [开发者指南](../DEVELOPMENT.md)

---

**提示**：如果您在使用过程中遇到问题，可以在插件设置中启用调试模式，查看详细的解析日志。
