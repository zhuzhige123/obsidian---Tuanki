<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>选择题界面测试</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
            line-height: 1.6;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .test-section {
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: #252526;
            border-radius: 12px;
            border: 1px solid #3c3c3c;
        }
        
        .test-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #58a6ff;
        }
        
        .preview-container {
            border: 1px solid #3c3c3c;
            border-radius: 8px;
            background: #1e1e1e;
            padding: 1rem;
            min-height: 300px;
        }
        
        .test-controls {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .test-btn {
            padding: 0.5rem 1rem;
            background: #58a6ff;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.875rem;
            transition: background 0.2s;
        }
        
        .test-btn:hover {
            background: #4c94e6;
        }
        
        .test-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .status {
            padding: 0.5rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            font-size: 0.875rem;
        }
        
        .status.success {
            background: rgba(63, 185, 80, 0.2);
            color: #3fb950;
            border: 1px solid #3fb950;
        }
        
        .status.error {
            background: rgba(248, 81, 73, 0.2);
            color: #f85149;
            border: 1px solid #f85149;
        }
        
        .status.info {
            background: rgba(88, 166, 255, 0.2);
            color: #58a6ff;
            border: 1px solid #58a6ff;
        }
    </style>
    <link rel="stylesheet" href="./styles/choice-card.css">
</head>
<body>
    <div class="container">
        <h1>选择题界面测试</h1>
        
        <div class="test-section">
            <div class="test-title">单选题测试</div>
            <div class="test-controls">
                <button class="test-btn" onclick="loadSingleChoice()">加载单选题</button>
                <button class="test-btn" onclick="loadMultipleChoice()">加载多选题</button>
                <button class="test-btn" onclick="clearPreview()">清空预览</button>
            </div>
            <div id="status" class="status info">点击按钮加载测试内容</div>
            <div id="preview-container" class="preview-container">
                <!-- 选择题界面将在这里渲染 -->
            </div>
        </div>
        
        <div class="test-section">
            <div class="test-title">测试数据</div>
            <div>
                <h4>单选题示例：</h4>
                <pre style="background: #0d1117; padding: 1rem; border-radius: 6px; overflow-x: auto;">
题目：以下哪个是JavaScript的数据类型？

A. String
B. Integer  
C. Float
D. Character

正确答案：A
解析：JavaScript有七种基本数据类型，包括String、Number、Boolean等。
                </pre>
                
                <h4>多选题示例：</h4>
                <pre style="background: #0d1117; padding: 1rem; border-radius: 6px; overflow-x: auto;">
题目：以下哪些是前端框架？

A. React
B. Vue.js
C. Angular
D. Django

正确答案：A, B, C
解析：React、Vue.js和Angular都是前端框架，而Django是Python的后端框架。
                </pre>
            </div>
        </div>
    </div>

    <script>
        // 模拟选择题数据
        const singleChoiceData = {
            cardType: 'multiple-choice',
            sections: [
                {
                    id: 'question',
                    type: 'front',
                    content: '以下哪个是JavaScript的数据类型？',
                    renderMode: 'markdown'
                },
                {
                    id: 'options',
                    type: 'options',
                    content: 'A. String\nB. Integer\nC. Float\nD. Character',
                    renderMode: 'mixed',
                    metadata: {
                        options: [
                            { label: 'A', text: 'String', index: 0 },
                            { label: 'B', text: 'Integer', index: 1 },
                            { label: 'C', text: 'Float', index: 2 },
                            { label: 'D', text: 'Character', index: 3 }
                        ],
                        correctAnswers: ['A'],
                        allowMultiple: false
                    }
                },
                {
                    id: 'explanation',
                    type: 'explanation',
                    content: 'JavaScript有七种基本数据类型，包括String、Number、Boolean等。',
                    renderMode: 'markdown'
                }
            ]
        };

        const multipleChoiceData = {
            cardType: 'multiple-choice',
            sections: [
                {
                    id: 'question',
                    type: 'front',
                    content: '以下哪些是前端框架？',
                    renderMode: 'markdown'
                },
                {
                    id: 'options',
                    type: 'options',
                    content: 'A. React\nB. Vue.js\nC. Angular\nD. Django',
                    renderMode: 'mixed',
                    metadata: {
                        options: [
                            { label: 'A', text: 'React', index: 0 },
                            { label: 'B', text: 'Vue.js', index: 1 },
                            { label: 'C', text: 'Angular', index: 2 },
                            { label: 'D', text: 'Django', index: 3 }
                        ],
                        correctAnswers: ['A', 'B', 'C'],
                        allowMultiple: true
                    }
                },
                {
                    id: 'explanation',
                    type: 'explanation',
                    content: 'React、Vue.js和Angular都是前端框架，而Django是Python的后端框架。',
                    renderMode: 'markdown'
                }
            ]
        };

        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        function loadSingleChoice() {
            updateStatus('正在加载单选题...', 'info');
            try {
                renderChoiceCard(singleChoiceData);
                updateStatus('单选题加载成功', 'success');
            } catch (error) {
                updateStatus(`加载失败: ${error.message}`, 'error');
            }
        }

        function loadMultipleChoice() {
            updateStatus('正在加载多选题...', 'info');
            try {
                renderChoiceCard(multipleChoiceData);
                updateStatus('多选题加载成功', 'success');
            } catch (error) {
                updateStatus(`加载失败: ${error.message}`, 'error');
            }
        }

        function clearPreview() {
            const container = document.getElementById('preview-container');
            container.innerHTML = '';
            updateStatus('预览已清空', 'info');
        }

        function renderChoiceCard(data) {
            const container = document.getElementById('preview-container');
            container.innerHTML = '';

            // 创建选择题卡片
            const card = document.createElement('div');
            card.className = 'tuanki-choice-card';

            // 渲染题目
            const questionSection = data.sections.find(s => s.type === 'front');
            if (questionSection) {
                const questionDiv = createQuestionElement(
                    questionSection.content,
                    data.sections.find(s => s.type === 'options')?.metadata?.allowMultiple || false
                );
                card.appendChild(questionDiv);
            }

            // 渲染选项
            const optionsSection = data.sections.find(s => s.type === 'options');
            if (optionsSection && optionsSection.metadata?.options) {
                const optionsDiv = createOptionsElement(
                    optionsSection.metadata.options,
                    optionsSection.metadata.correctAnswers || ['A'],
                    optionsSection.metadata.allowMultiple || false
                );
                card.appendChild(optionsDiv);
            }

            container.appendChild(card);
        }

        function createQuestionElement(content, isMultipleChoice) {
            const questionDiv = document.createElement('div');
            questionDiv.className = 'tuanki-choice-question';

            questionDiv.innerHTML = `
                <div class="tuanki-choice-question-title">
                    <span class="tuanki-choice-label">${isMultipleChoice ? '多选题' : '单选题'}</span>
                </div>
                <div class="tuanki-choice-question-content">${content}</div>
            `;

            return questionDiv;
        }

        function createOptionsElement(options, correctAnswers, isMultipleChoice) {
            const optionsDiv = document.createElement('div');
            optionsDiv.className = 'tuanki-choice-options';

            options.forEach(option => {
                const optionButton = document.createElement('button');
                optionButton.className = 'tuanki-choice-option';
                optionButton.setAttribute('data-option-id', option.label);

                optionButton.innerHTML = `
                    <div class="tuanki-choice-option-label">${option.label}</div>
                    <div class="tuanki-choice-option-content">
                        <div class="option-text">${option.label}</div>
                        <div class="option-description">${option.text}</div>
                    </div>
                    <div class="tuanki-choice-option-indicator"></div>
                `;

                // 添加点击事件
                optionButton.addEventListener('click', () => {
                    handleOptionClick(optionButton, option.label, isMultipleChoice);
                });

                optionsDiv.appendChild(optionButton);
            });

            return optionsDiv;
        }

        function handleOptionClick(element, optionId, isMultipleChoice) {
            if (isMultipleChoice) {
                // 多选题逻辑
                element.classList.toggle('tuanki-choice-option--selected');
            } else {
                // 单选题逻辑
                document.querySelectorAll('.tuanki-choice-option').forEach(opt => {
                    opt.classList.remove('tuanki-choice-option--selected');
                });
                element.classList.add('tuanki-choice-option--selected');
            }

            // 添加动画效果
            element.style.animation = 'pulse 0.3s ease-in-out';
            setTimeout(() => {
                element.style.animation = '';
            }, 300);
        }

        // 页面加载完成后自动加载单选题示例
        window.addEventListener('load', () => {
            setTimeout(() => {
                loadSingleChoice();
            }, 500);
        });
    </script>
</body>
</html>
